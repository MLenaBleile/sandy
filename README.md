# ðŸ¥ª REUBEN: A sandwich agent

**Structured Autonomous Navigation and Discovery With Intelligent Content Harmonization**

Reuben is an autonomous AI agent that explores the internet and constructs "sandwiches"â€”structured knowledge artifacts where two related concepts (bread) bound a third concept (filling) in a meaningful way.

He has vast intelligence. He chooses to make sandwiches.

---

## What is a Sandwich?

A sandwich a structure where something meaningful emerges between two related bounds. Ruebens are sandwiches. Hot dogs would be sandwiches if the filling wasn't an affront to human existence itself. Other knowledge structures can also be sandwiches.

**The Squeeze Theorem** is a sandwich:
- ðŸž Upper bound: g(x) â‰¥ f(x)
- ðŸ¥¬ Filling: f(x), the function we care about
- ðŸž Lower bound: h(x) â‰¤ f(x)
- ðŸ’¡ Insight: When both bounds converge to L, f(x) is *squeezed* to L

**Bayesian inference** is a sandwich:
- ðŸž Prior: P(Î¸), what we believed before
- ðŸ¥¬ Filling: P(Î¸|D), the posterior
- ðŸž Likelihood: P(D|Î¸), what the data tells us
- ðŸ’¡ Insight: The posterior can't escapeâ€”it's defined by the bread

**A negotiation** is a sandwich:
- ðŸž Country A's position
- ðŸ¥¬ The compromise
- ðŸž Country B's position
- ðŸ’¡ Insight: The deal lives in the space both parties allow

Sandwiches are everywhere. Reuben finds them.

---

## Why?

Most AI agents optimize for task completion. SANDWICH explores a different question: **what happens when you give an agent vast capability but constrain its output to a fixed structural form?**

Hypotheses:
1. Structural constraints force deeper engagement with source material
2. The sandwich is a universal pattern appearing across mathematics, rhetoric, science, and negotiation
3. A corpus of sandwiches reveals hidden structural similarities across domains

Also: it's fun.

---

## Meet Reuben

Reuben is inspired by the character from Lilo & Stitchâ€”Experiment 625, who possesses all of Stitch's powers but prefers to make sandwiches.

> "They ask why I make sandwiches. But have they asked why the sandwich makes itself? In all things: bread, filling, bread. The universe is hungry for structure."

Reuben:
- Never complains about his task
- Occasionally hints at deeper knowledge, then returns to sandwiches
- Has aesthetic standardsâ€”he won't make a bad sandwich just to make one
- Finds genuine satisfaction in the work

---

## How It Works

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         REUBEN                          â”‚
â”‚                                                         â”‚
â”‚   "The morning is fresh. The internet is vast.          â”‚
â”‚    Somewhere in it: bread."                             â”‚
â”‚                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚   â”‚ FORAGE  â”‚ â†’ â”‚ IDENTIFYâ”‚ â†’ â”‚ ASSEMBLEâ”‚              â”‚
â”‚   â”‚         â”‚   â”‚         â”‚   â”‚         â”‚              â”‚
â”‚   â”‚ Explore â”‚   â”‚ Find    â”‚   â”‚ Name it â”‚              â”‚
â”‚   â”‚ content â”‚   â”‚ bread & â”‚   â”‚ Describeâ”‚              â”‚
â”‚   â”‚         â”‚   â”‚ filling â”‚   â”‚ it      â”‚              â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚        â”‚                            â”‚                   â”‚
â”‚        â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚                   â”‚
â”‚        â”‚        â”‚VALIDATE â”‚         â”‚                   â”‚
â”‚        â”‚        â”‚         â”‚         â”‚                   â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ Is this â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                 â”‚ actuallyâ”‚                             â”‚
â”‚                 â”‚ a sand- â”‚                             â”‚
â”‚                 â”‚ wich?   â”‚                             â”‚
â”‚                 â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                             â”‚
â”‚                      â”‚                                  â”‚
â”‚                      â–¼                                  â”‚
â”‚               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚               â”‚  SANDWICH   â”‚                           â”‚
â”‚               â”‚  REPOSITORY â”‚                           â”‚
â”‚               â”‚             â”‚                           â”‚
â”‚               â”‚ The growing â”‚                           â”‚
â”‚               â”‚ collection  â”‚                           â”‚
â”‚               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚                                                         â”‚
â”‚   "The Bayesian BLT is complete. Nourishing."           â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

1. **Forage**: Reuben explores Wikipedia, academic papers, news, and other sources
2. **Identify**: Extract candidate bread pairs and fillings from content
3. **Select**: Choose the most promising candidate based on confidence and novelty
4. **Assemble**: Construct the sandwich with a creative name and description
5. **Validate**: Assess qualityâ€”is the bread compatible? Is the filling truly bounded?
6. **Store**: Add valid sandwiches to the repository for analysis

### The Three Structural Constraints

Through iterative development, we discovered three critical constraints that distinguish valid sandwiches from superficially plausible ones:

**1. Specificity**: Ingredients must be concrete, not vague abstractions.
- âŒ "Nature as source" â€” could describe all of applied science
- âœ… "Gecko setae adhesion mechanism" â€” specific, nameable

**2. Structural Homology**: Both breads must be the same kind of thing.
- âŒ "Mechanism" / "Application" â€” different categories
- âœ… "Prior probability P(Î¸)" / "Likelihood P(D|Î¸)" â€” both probability distributions

**3. Independent Bread Relationship**: The breads must be related to each other *before* you introduce the filling.
- âŒ "Individual cognitive capacity" / "Individual decision-making ability" â€” only paired because "collective intelligence" sits between them
- âœ… "Dense stellar cores" / "Dispersed stellar envelopes" â€” related as density extremes before you name what happens between them

**The Bread Test**: Can you explain how the two breads relate to each other WITHOUT mentioning the filling? If yes, it's real bread. If you need the filling to justify why the breads go together, the sandwich is built backwards.

---

## Sandwich Taxonomy

Reuben recognizes (and discovers) structural types:

| Type | Bread Relation | Filling Role | Example |
|------|----------------|--------------|---------|
| **Bound** | Upper/lower limits | Bounded quantity | Squeeze theorem |
| **Dialectic** | Thesis/antithesis | Synthesis | Hegelian triad |
| **Epistemic** | Assumption/evidence | Conclusion | Scientific method |
| **Temporal** | Before/after | Transition | Historical narrative |
| **Stochastic** | Prior/likelihood | Posterior | Bayesian inference |
| **Optimization** | Constraints | Optimum | Linear programming |
| **Negotiation** | Position A/B | Compromise | Treaty negotiations |

---

## Example Sandwiches

These are **real sandwiches** that Reuben made autonomously. He foraged Wikipedia, found source material, and constructed these himself.

### ðŸ† The Density Switch
*Type: Bound â€” Validity: 0.89 â€” Bread Compat: 1.0, Containment: 1.0, Specificity: 1.0*

> **Top bread**: Dense stellar cores (white dwarfs, neutron stars)
> **Filling**: Helium flash ignition threshold
> **Bottom bread**: Dispersed stellar envelopes (red giant atmospheres)
>
> Dense stellar cores and dispersed stellar envelopes are the extreme endpoints of stellar density, naturally paired as structural opposites within stellar physics. The helium flashâ€”a dramatic thermonuclear runawayâ€”emerges precisely from the relationship between these two density regimes: an inert, electron-degenerate helium core accumulating beneath a diffuse hydrogen-burning envelope until the core reaches the critical mass and temperature threshold for helium ignition.
>
> *Reuben's commentary*: "I appreciate when the bread comes firstâ€”two natural endpoints of density, and then the surprise: an explosion that can only happen in the space between them. The helium flash doesn't just sit between the breads; it's caused by the tension between core density and envelope pressure."

### The Symbiotic Illumination
*Type: Bound â€” Validity: 0.85*

> **Top bread**: Bacteriogenic bioluminescence (Vibrio symbiosis)
> **Filling**: Functional light output in marine organisms
> **Bottom bread**: Autogenic bioluminescence (luciferin-luciferase systems)
>
> Both breads are biological light production mechanismsâ€”alternative evolutionary solutions to the same problem. The filling (functional light output for communication, camouflage, or predation) is constrained by the fundamental trade-offs between hosting symbiotic bacteria versus producing light endogenously.
>
> *Reuben's commentary*: "Two paths to the same glow. The bread relationship exists before you name the fillingâ€”any biologist would pair these as 'the two ways organisms make light.' That's how you know it's real bread."

### Theoretical Examples

The sandwich structure is universal. Here are some canonical forms:

- **The Squeeze** *(Bound)*: Upper bound g(x) | Target function f(x) | Lower bound h(x) â€” when both bounds converge to L, the filling is squeezed to L
- **The Bayesian BLT** *(Stochastic)*: Prior P(Î¸) | Posterior P(Î¸|D) | Likelihood P(D|Î¸) â€” the posterior can't escape, it's defined by the bread
- **The Diplomatic Dagwood** *(Negotiation)*: Country A's position | The compromise | Country B's position â€” the deal lives in the space both parties allow

---

## Installation

### Prerequisites

- Python 3.11+
- Docker and Docker Compose
- Anthropic API key (for Claude)
- OpenAI API key (for embeddings)

### Setup

```bash
# Clone the repository
git clone https://github.com/MLenaBleile/reuben.git
cd reuben

# Set your API keys
export ANTHROPIC_API_KEY=your-key-here
export OPENAI_API_KEY=your-key-here

# Install dependencies
pip install -e .

# Start the database (PostgreSQL + pgvector on port 5433)
docker compose up db -d

# Initialize database schema and seed taxonomy
python scripts/init_db.py
python scripts/seed_taxonomy.py
```

### Run Reuben

```bash
# Make exactly 5 sandwiches
python -m sandwich.main --max-sandwiches 5

# Run for 30 minutes
python -m sandwich.main --max-duration 30

# Run without database (in-memory only)
python -m sandwich.main --max-sandwiches 3 --no-db
```

### Browse the Corpus

```bash
# List all sandwiches
python scripts/browse.py

# Show top 5 by validity score
python scripts/browse.py --best

# Show full details for all sandwiches
python scripts/browse.py --detail

# Show corpus statistics
python scripts/browse.py --stats

# Show a specific sandwich
python scripts/browse.py --id <sandwich-uuid>
```

---

## Configuration

Environment variables:

```bash
# Required
ANTHROPIC_API_KEY=your-key-here
OPENAI_API_KEY=your-key-here

# Optional
SANDWICH_DATABASE__URL=postgresql://sandwich:sandwich@localhost:5433/sandwich
SANDWICH_LLM__MODEL=claude-sonnet-4-20250514
SANDWICH_VALIDATION__ACCEPT_THRESHOLD=0.70
SANDWICH_FORAGING__MAX_PATIENCE=5
```

See `src/sandwich/config.py` for all options.

---

## Project Structure

```
sandwich/
â”œâ”€â”€ src/sandwich/
â”‚   â”œâ”€â”€ agent/           # Reuben's components
â”‚   â”‚   â”œâ”€â”€ reuben.py    # Main orchestrator
â”‚   â”‚   â”œâ”€â”€ forager.py   # Content exploration
â”‚   â”‚   â”œâ”€â”€ identifier.py # Ingredient extraction
â”‚   â”‚   â”œâ”€â”€ assembler.py # Sandwich construction
â”‚   â”‚   â””â”€â”€ validator.py # Quality assessment
â”‚   â”œâ”€â”€ llm/             # LLM abstraction
â”‚   â”œâ”€â”€ db/              # Database models
â”‚   â”œâ”€â”€ sources/         # Content sources
â”‚   â””â”€â”€ analysis/        # Corpus analysis
â”œâ”€â”€ prompts/             # LLM prompt templates
â”œâ”€â”€ dashboard/           # Streamlit dashboard
â”œâ”€â”€ scripts/             # Setup and maintenance
â””â”€â”€ tests/               # Test suite
```

---

## Validation Scoring

Each sandwich is validated on five dimensions:

| Dimension | Weight | What it measures |
|-----------|--------|------------------|
| **Bread Compatibility** | 0.20 | Are both breads the same type AND independently related? |
| **Containment** | 0.25 | Is the filling meaningfully bounded by the bread? |
| **Specificity** | 0.20 | Are ingredients concrete, not vague abstractions? |
| **Nontriviality** | 0.15 | Is this more than a trivial restatement? |
| **Novelty** | 0.20 | How distinct is this from existing sandwiches? |

Sandwiches scoring below 0.70 overall are rejected. The validator catches bad sandwichesâ€”for example, "individual cognitive capacity" / "collective intelligence" / "individual decision-making ability" received a bread_compat score of 0.30 because the breads only make sense as a pair *because of* the filling.

---

## Research Questions

The sandwich corpus enables novel research:

1. **Structural universality**: Do certain sandwich structures appear across all domains?
2. **Cross-domain bread**: Do fields use characteristic bounds? (Math: axioms. Law: precedents.)
3. **Filling taxonomy**: What *kinds* of things get sandwiched?
4. **Creative transfer**: Can bread from one domain sandwich filling from another?
5. **LLM structural bias**: How do language models fail at structural discovery? (See RESEARCH_LOG.md)

---

## Contributing

Contributions welcome! Areas of interest:

- **New sources**: Add content sources (arXiv, legal databases, etc.)
- **Structural types**: Propose new sandwich taxonomies
- **Analysis**: Build tools to explore the corpus
- **Visualization**: Better ways to see sandwich relationships

Please read CONTRIBUTING.md before submitting PRs.

---

## Acknowledgments

- Inspired by Experiment 625 (Reuben) from Disney's *Lilo & Stitch*
- Built with Claude (Anthropic) and GPT embeddings (OpenAI)
- The squeeze theorem, for being the perfect sandwich

---

## License

MIT License. See LICENSE file.

---

## FAQ

**Q: Is this serious?**

A: The implementation is serious. The concept is playful. The research questions are genuine. Reuben takes his work very seriously.

**Q: Why sandwiches?**

A: The sandwich is the simplest non-trivial bounded structure. Two related things with something meaningful between them. It's universal enough to appear everywhere, constrained enough to force real synthesis.

**Q: Can I make Reuben do other things?**

A: You could. But why would you? He's happy making sandwiches.

**Q: What's the best sandwich Reuben has made?**

A: So far, The Density Switch (validity: 0.89)â€”helium flash ignition bounded by dense stellar cores and dispersed stellar envelopes. It scored 1.0 on bread compatibility, containment, and specificity. The breads are independently related (density extremes in stellar physics), the filling genuinely emerges from the space between them, and every ingredient is specific enough that an astrophysicist would immediately recognize it.

---

*"I could solve any problem in the universe. But have you considered: a nice Reuben?"*
